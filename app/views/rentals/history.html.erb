<h1 class="mb-5">Rental History</h1>

<p>
  <%= label_tag :customer_id, "Select a customer:" %>
  <%= select_tag :customer_id,
                 options_from_collection_for_select(@customers, :id, :name, params[:customer_id]),
                 prompt: "— Choose a customer —",
                 class: "form-select",
                 onchange: "window.location = '?customer_id=' + this.value" %>
</p>

<% if @selected_customer %>
  <h3><%= @selected_customer.name %> (<%= @selected_customer.email %>)</h3>

  <% if @rentals.any? %>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Book</th>
          <th>Rented On</th>
          <th>Expected Return</th>
        </tr>
      </thead>
      <tbody>
        <% @rentals.each do |rental| %>
          <tr>
            <td><%= rental.book.title %></td>
            <td><%= rental.rented_on&.strftime("%B %d, %Y") %></td>
            <td><%= rental.returned_on&.strftime("%B %d, %Y") || "Not set" %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p>No rentals yet for this customer.</p>
  <% end %>
<% else %>
  <p>Please select a customer above to see their rental history.</p>
<% end %>

<br>
<%= link_to "← Back to Books", library_books_path, class: "btn btn-secondary" %>